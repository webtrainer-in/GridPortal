<div class="dynamic-grid-container">
  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
    <span>Loading data...</span>
  </div>

  <!-- Pagination mode indicator -->
  <div class="pagination-info">
    <span class="mode-badge" [class.client-side]="!isServerSidePagination" [class.server-side]="isServerSidePagination">
      {{ isServerSidePagination ? 'Server-Side Pagination' : 'Client-Side Pagination' }}
    </span>
    <span class="record-count">Total Records: {{ totalCount }}</span>
  </div>

  <!-- AG Grid -->
  <ag-grid-angular
    class="ag-theme-quartz grid-container"
    [columnDefs]="columnDefs"
    [rowData]="rowData"
    [getRowStyle]="getRowStyle"
    [animateRows]="true"
    [pagination]="!isServerSidePagination"
    [paginationPageSize]="pageSize"
    [paginationPageSizeSelector]="[15, 25, 50, 100]"
    (gridReady)="onGridReady($event)"
    (sortChanged)="onSortChanged()"
    (filterChanged)="onFilterChanged()"
  ></ag-grid-angular>

  <!-- Custom pagination controls (shown only for server-side pagination) -->
  <div *ngIf="isServerSidePagination" class="custom-pagination">
    <!-- Page Size Selector (leftmost) -->
    <div class="page-size-selector">
      <label for="page-size">Page Size:</label>
      <select 
        id="page-size" 
        [(ngModel)]="pageSize" 
        (change)="onPageSizeChange()"
        [disabled]="isLoading">
        <option [value]="15">15</option>
        <option [value]="25">25</option>
        <option [value]="50">50</option>
        <option [value]="100">100</option>
      </select>
    </div>
    
    <!-- Record Range Info -->
    <div class="pagination-info-text">
      <span>{{ getStartRecord() }} to {{ getEndRecord() }} of {{ totalCount }}</span>
    </div>
    
    <!-- First Page Button -->
    <button 
      class="pagination-btn icon-btn" 
      [disabled]="currentPage === 1 || isLoading"
      (click)="goToPage(1)"
      title="First Page">
      ⏮
    </button>
    
    <!-- Previous Page Button -->
    <button 
      class="pagination-btn icon-btn" 
      [disabled]="!canGoPrevious || isLoading" 
      (click)="previousPage()"
      title="Previous Page">
      ◀
    </button>
    
    <!-- Page Info -->
    <div class="pagination-info-text">
      <span>Page {{ currentPage }} of {{ totalPages }}</span>
    </div>
    
    <!-- Next Page Button -->
    <button 
      class="pagination-btn icon-btn" 
      [disabled]="!canGoNext || isLoading" 
      (click)="nextPage()"
      title="Next Page">
      ▶
    </button>
    
    <!-- Last Page Button -->
    <button 
      class="pagination-btn icon-btn" 
      [disabled]="currentPage === totalPages || isLoading"
      (click)="goToPage(totalPages)"
      title="Last Page">
      ⏭
    </button>
  </div>
</div>
