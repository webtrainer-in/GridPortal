<div class="secondary-panel" 
     [class.open]="isOpen" 
     [class.far-right]="panelPosition === 'far-right'"
     [class.resizing]="isResizing"
     [style.width.px]="isOpen ? panelWidth : 0">
  
  <!-- Resize handle for next-to-sidebar position (right edge) -->
  <div class="resize-handle resize-handle-right" 
       *ngIf="isOpen && panelPosition === 'next-to-sidebar'"
       (mousedown)="onResizeStart($event)"
       title="Drag to resize panel">
  </div>
  
  <!-- Resize handle for far-right position (left edge) -->
  <div class="resize-handle resize-handle-left" 
       *ngIf="isOpen && panelPosition === 'far-right'"
       (mousedown)="onResizeStart($event)"
       title="Drag to resize panel">
  </div>
  <div class="panel-header">
    <div class="header-content">
      <h3 class="panel-title">
        <i class="pi pi-folder-open panel-icon"></i>
        {{ getMenuTitle() }}
      </h3>
      <div class="panel-controls">
        <button 
          class="position-toggle" 
          (click)="togglePosition()"
          title="Toggle position">
          <i class="pi pi-arrows-h"></i>
        </button>
        <button 
          class="close-button" 
          (click)="closePanel()"
          title="Close panel">
          <i class="pi pi-times"></i>
        </button>
      </div>
    </div>
  </div>
  
  <div class="panel-content" *ngIf="isOpen">
    <!-- Tab Content -->
    <div class="tab-content-container">
      <!-- Generic Tab Content with Recursive Menu Tree -->
      <div class="tab-content" [class.active]="true" *ngIf="shouldShowTabs()">
        <div class="tree-view">
          <app-recursive-menu-tree 
            [items]="getActiveTabContent()" 
            [level]="0"
            [expandedItems]="expandedMenuItems"
            (itemClick)="onMenuItemClick($event)"
            (toggleExpand)="onToggleMenuExpand($event)">
          </app-recursive-menu-tree>
        </div>
      </div>

      <!-- Non-tabbed content with Recursive Menu Tree -->
      <div class="tab-content" [class.active]="!shouldShowTabs()">
        <div class="tree-view">
          <app-recursive-menu-tree 
            [items]="getActiveTabContent()" 
            [level]="0"
            [expandedItems]="expandedMenuItems"
            (itemClick)="onMenuItemClick($event)"
            (toggleExpand)="onToggleMenuExpand($event)">
          </app-recursive-menu-tree>
        </div>
      </div>
    </div>

    <!-- Tab Navigation at bottom -->
    <div class="tab-navigation tab-navigation-bottom" *ngIf="shouldShowTabs()">
      <div class="tab-buttons">
        <button 
          *ngFor="let tab of getTabs()" 
          class="tab-button"
          [class.active]="activeTab === tab.id"
          (click)="setActiveTab(tab.id)">
          <i [class]="tab.icon"></i>
          {{ tab.label }}
        </button>
      </div>
    </div>
  </div>
</div>